import{r as e,j as p}from"./jsx-runtime-DexIYAB0.js";import{u as Y,c as q,b as K,m as U,L as Z,a as $,t as J,n as O}from"./heading-ZPF0v02j.js";import{u as Q}from"./image-CqMHUZOp.js";import{W as ee,h as te,o as re,e as se,S as ne,p as oe,G as ae,q as ie,D as x,r as ce,c as ue,a as le,m as me,n as de}from"./three-BzMM05cl.js";import{t as pe}from"./throttle-BgiUmwhn.js";import{u as C}from"./use-spring-Djz_GPhj.js";import"./components-DHYEfo0O.js";import"./index-fV9LVAaB.js";const fe="/julesmeister.github.io/assets/volkihar-cube-nx-B7Zjde9E.jpg",he="/julesmeister.github.io/assets/volkihar-cube-ny-K8Ej-0KC.jpg",ve="/julesmeister.github.io/assets/volkihar-cube-nz-CwSlGC5m.jpg",ge="/julesmeister.github.io/assets/volkihar-cube-px-B6VuHL6s.jpg",be="/julesmeister.github.io/assets/volkihar-cube-py-nbSfCjcD.jpg",we="/julesmeister.github.io/assets/volkihar-cube-pz-Bzqv8d-T.jpg",xe="/julesmeister.github.io/assets/volkihar-knight-BtFNLzdG.glb",je="_armor_1taf3_1",Le="_loader_1taf3_13",ye="_canvas_1taf3_31",j={armor:je,loader:Le,canvas:ye},z={stiffness:40,damping:20,mass:1.5},Ge=({showDelay:T=0,cameraPosition:f={x:0,y:0,z:6},className:M,alt:G,..._})=>{const[L,P]=e.useState(!1),[V,B]=e.useState(!1),[N,W]=e.useState(!1),u=e.useRef(),y=e.useRef(),l=e.useRef(),i=e.useRef(),n=e.useRef(),t=e.useRef(),h=e.useRef(),v=Q(u,!1,{threshold:.4}),k=Y(),g=C(0,z),b=C(0,z);e.useEffect(()=>{const{clientWidth:r,clientHeight:s}=u.current;t.current=new ee({canvas:y.current,alpha:!0,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),t.current.setPixelRatio(2),t.current.setSize(r,s),t.current.outputColorSpace=te,t.current.toneMapping=re,l.current=new se(36,r/s,.1,100),l.current.position.set(f.x,f.y,f.z),n.current=new ne;const o=new oe;i.current=new ae,n.current.add(i.current);const c=new ie(t.current);c.compileCubemapShader();const d=new x(16777215,2.6),S=new x(16777215,1),R=new x(16777215,1.3);d.position.set(1,.1,2),S.position.set(-1,.1,8),R.position.set(-2,2,-3),h.current=[R,d,S],h.current.forEach(a=>n.current.add(a));const A=async()=>{const a=me.loadAsync(xe),F=o.loadAsync([fe,he,ve,ge,be,we]),[w,I]=await Promise.all([a,F]);i.current.add(w.scene),w.scene.rotation.y=de.degToRad(180),w.scene.position.y=-1.6;const{texture:X}=c.fromCubemap(I);n.current.environment=X,c.dispose(),await t.current.initTexture(n.current.environment),i.current.traverse(async E=>{E.material&&await t.current.initTexture(E.material)}),P(!0),m()};e.startTransition(()=>{A(),setTimeout(()=>{W(!0)},1e3)});const H=g.on("change",a=>{i.current.rotation.x=a,m()}),D=b.on("change",a=>{i.current.rotation.y=a,m()});return()=>{ce(h.current),ue(n.current),le(t.current),H(),D()}},[]);const m=e.useCallback(()=>{t.current.render(n.current,l.current)},[]);return e.useEffect(()=>{const r=pe(s=>{const{innerWidth:o,innerHeight:c}=window,d={x:(s.clientX-o/2)/o,y:(s.clientY-c/2)/c};g.set(d.y/2),b.set(d.x/2)},100);return v&&B(!0),v&&!k&&window.addEventListener("mousemove",r),()=>{window.removeEventListener("mousemove",r)}},[v,k,g,b]),e.useEffect(()=>{const r=()=>{if(!u.current)return;const{clientWidth:s,clientHeight:o}=u.current;t.current.setSize(s,o),l.current.aspect=s/o,l.current.updateProjectionMatrix(),m()};return window.addEventListener("resize",r),r(),()=>{window.removeEventListener("resize",r)}},[m]),p.jsxs("div",{className:q(j.armor,M),ref:u,role:"img","aria-label":G,..._,children:[p.jsx(K,{unmount:!0,in:!L&&N,timeout:U(J.base.durationL),children:({visible:r})=>p.jsx(Z,{className:j.loader,"data-visible":r})}),p.jsx("canvas",{className:j.canvas,ref:y,"data-loaded":L&&V,style:$({delay:O(T)})})]})};export{Ge as Armor};
